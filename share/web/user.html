<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD><TITLE>Advene Users Wiki: AdveneUserGuide</TITLE>
<META NAME='KEYWORDS' CONTENT='Advene, User, Guide'/>
<LINK REL="stylesheet" HREF="advene.css">
</HEAD><BODY BGCOLOR="white">

<hr class=wikilineheader></div><div class=wikitext><h1>Advene user guide</h1>

<p>
If you have a local copy of this file, you can find the original document (that may be more up to date) at: <a href="http://liris.cnrs.fr/advene/twiki/bin/wiki.pl?AdveneUserGuide">http://liris.cnrs.fr/advene/twiki/bin/wiki.pl?AdveneUserGuide</a>. You may also consult the 
<a href="http://liris.cnrs.fr/advene/twiki/bin/wiki.pl">[advene wiki]</a>. 
<p>

<p>
<h2>Warning</h2>

<p>
This user guide is far from being complete: not fully descriptive nor fully bilingual. 
As a wiki user, you can edit the text, and add your own corrections or precisions. Please register with a username in the Preferences menu, so that we can identify contributors.
This guide will be included as help file in any Advene release.
<p>
<span class="question">If you wish to add a question or a note in the text, you can use the question style mark.
<p>
<p>
<h2>Table of contents</h2>

<p>
<dl><dt> </dt><dd>1. <a href="#Creating_a_package">Creating a package</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>1.1. <a href="#Selecting_the_video_data">Selecting the video data</a></dd>
<dt> </dt><dd>1.2. <a href="#Creating_annotations">Creating annotations</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>1.2.1. <a href="#Creation_by_alignment_transcription">Creation by alignment transcription</a></dd>
<dt> </dt><dd>1.2.2. <a href="#Creation_by_importing_from_other_formats">Creation by importing from other formats</a></dd>
<dt> </dt><dd></dd></dl>

</dd></dl>

2. <a href="#Saving_a_package">Saving a package</a></dd>
<dt> </dt><dd>3. <a href="#Visualizing_annotations">Visualizing annotations</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>3.1. <a href="#Timeline_view">Timeline view</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>3.1.1. <a href="#Annotation_transmutation">Annotation transmutation</a></dd>
<dt> </dt><dd></dd></dl>

3.2. <a href="#Tree_view">Tree view</a></dd>
<dt> </dt><dd>3.3. <a href="#Hypertext_view">Hypertext view</a></dd>
<dt> </dt><dd>3.4. <a href="#Transcription_view">Transcription view</a></dd>
<dt> </dt><dd></dd></dl>

4. <a href="#TALES_syntax">TALES syntax</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>4.1. <a href="#The_Advene_model">The Advene model</a></dd>
<dt> </dt><dd>4.2. <a href="#TALES_use_in_the_web_server">TALES use in the web server</a></dd>
<dt> </dt><dd>4.3. <a href="#TALES_use_in_the_static_views">TALES use in the static views</a></dd>
<dt> </dt><dd>4.4. <a href="#TALES_use_in_the_dynamic_views">TALES use in the dynamic views</a></dd>
<dt> </dt><dd>4.5. <a href="#TALES_use_in_the_queries">TALES use in the queries</a></dd>
<dt> </dt><dd>4.6. <a href="#Access_to_package_specific_resources">Access to package-specific resources</a></dd>
<dt> </dt><dd></dd></dl>

5. <a href="#Dynamic_views">Dynamic views</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>5.1. <a href="#Definition">Definition</a></dd>
<dt> </dt><dd>5.2. <a href="#Automatic_launching">Automatic launching</a></dd>
<dt> </dt><dd></dd></dl>

6. <a href="#Static_views">Static views</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>6.1. <a href="#Default_static_view">Default static view</a></dd>
<dt> </dt><dd></dd></dl>

7. <a href="#Schema_definition">Schema definition</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>7.1. <a href="#New_schema_creation">New schema creation</a></dd>
<dt> </dt><dd>7.2. <a href="#Adding_an_annotation_type_to_a_schema">Adding an annotation type to a schema</a></dd>
<dt> </dt><dd>7.3. <a href="#Adding_a_relation_type_to_a_schema">Adding a relation type to a schema</a></dd>
<dt> </dt><dd></dd></dl>

8. <a href="#Package_elements_edition">Package elements edition</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>8.1. <a href="#Shared_attributes">Shared attributes</a></dd>
<dt> </dt><dd>8.2. <a href="#Package_specific_attributes">Package specific attributes</a></dd>
<dt> </dt><dd>8.3. <a href="#Annotation_types">Annotation types</a></dd>
<dt> </dt><dd><dl><dt> </dt><dd>8.3.1. <a href="#Simplistic_structured_form">Simplistic structured form</a></dd>
<dt> </dt><dd></dd></dl>

8.4. <a href="#Relation_types">Relation types</a></dd>
<dt> </dt><dd>8.5. <a href="#Views">Views</a></dd>
<dt> </dt><dd></dd></dl>

</dd></dl>


<p>
<h2><a name="Creating_a_package"></a>1. Creating a package</h2>

<p>
When the application is launched, a base package is loaded. It contains 
one schema <em>Texte simple</em> (Simple text), which defines 
one annotation type <em>Annotation texte</em> (Textual annotation) and one relation type 
<em>Relation élémentaire</em> (Elementary relation). It is thus possible to 
immediately annotate a video  with this initial schema.
<p>
<h3><a name="Selecting_the_video_data"></a>1.1. Selecting the video data</h3>

<p>
The choice of the video data is done through the application Graphical User Interface (GUI). It is possible to select either a DVD, through the DVD icon (and the select the appropriate title and chapter), or a video file through the <em>Eject</em> icon.
<p>
Once the video source selected, it is possible to navigate in the movie with the navigation buttons (play, pause, fast forward and rewind) and with the cursor. 
<p>
<h3><a name="Creating_annotations"></a>1.2. Creating annotations</h3>

<p>
<h4><a name="Creation_by_alignment_transcription"></a>1.2.1. Creation by alignment transcription</h4>

<p>
It is possible, from a textual transcription of the contents of the video, to simply pose timestamp marks, in order to generate annotations from the timestamped text. This function is available from the menu <em>File/Import a transcription</em>.
<p>
Once the video is started, timestamps marks can be set just by clicking in the text at the right moment. A time difference
is automatically added, for taking into account reaction time. Its default value is -200ms, but it is possible to adjust it.
Clicking on a erroneous timestamp mark deletes it. A right click on a mark gives access to several commands: move the player 
to the moment it indicates, make temporal adjustments. It is also possible to indicate 
that Advene should not to take into account the text between a mark and the following one. Such "ignored text" marks are represented with a light red color.
<p>
After having completed the edition of marks, click on <em>convert</em> to convert 
the text into annotations of a chosen type. At any moment, you can save and 
reload your transcription work in the import transcription window.
<p>
<h4><a name="Creation_by_importing_from_other_formats"></a>1.2.2. Creation by importing from other formats</h4>

<p>
The import module can generate a package of annotations (and often also schemas) from another file format. The formats supported at the moment (version 0.17) are:
<UL >
<li> Elementary text (.txt files), where each line contains the time of beginning, the time of end and the contents of the annotation, separated by tabs. 
<li> the subtitle format SRT (.srt files). 
<li> format Xi (xml files)
<li> the format ELAN (.eaf files).
<li> the PRRAT format
</UL>
<p>
You can import external data through the menu <em>File/Import file</em> 
<p>
<h2><a name="Saving_a_package"></a>2. Saving a package</h2>

<p>
There are two storage formats for packages: a native XML format, and a OpenDocument-like format, that stores the package data (in XML format) and associated resources (resources such as CSS files, images...) in a Zip file. The format is indicated by the filename extension: .xml for XML format, .azp for Advene Zip Files.
<p>
<h2><a name="Visualizing_annotations"></a>3. Visualizing annotations</h2>

<p>
After having created some annotations, it's possible to visualize them through the graphical interface or the web server. We are going to detail some of these visualization modules.
<p>
<a name="Timeline"></a>
<h3><a name="Timeline_view"></a>3.1. Timeline view</h3>

<p>
The timeline view shows a linear representation of the annotations, where
each line corresponds to an annotation type. The slider in the lower 
left-hand corner of the window indicates the zoom factor. A click on 
the timestamps marks that are on the top of the window changes the 
zoom factor: left-click zooms in, right-click zooms out. The keys 1 to 9
also set the zoom factor (1 displays the whole timeline, 9 displays 
a small fraction of the timeline)
<p>
<h4><a name="Annotation_transmutation"></a>3.1.1. Annotation transmutation</h4>

<p>
To change the type of an annotation, just drag and drop the annotation upon the 
desired annotation type in the left-hand side of the window. If the delete icon is 
activated, the original annotation will be deleted, otherwise, it will simply
be duplicated in a new type.
<p>
<h3><a name="Tree_view"></a>3.2. Tree view</h3>

<p>
A tree view of the package is available through the main window. It's also possible to open new ones through the 'view' menu.This view allow the creation of new elements in the package through the contextual menus accessible by right-clicking on the elements.
<p>
The contextual menu of the package (root element) allow the creation of new schemes, new views or new queries.
<p>
The contextual menu of the schemes allow the creation of new types of annotation or relation in the selected schema.
<p>
<h3><a name="Hypertext_view"></a>3.3. Hypertext view</h3>

<p>
An integrated web server, based on the views defined in the Advene model, give acces to the content of the package by the mean of a simple web browser.
For that, we can use the element <em>Launch the Web browser</em> of the menu <em>View</em> or directly indicate the URL in the browser:
<p>
<a href="http://localhost:1234/packages/advene/">http://localhost:1234/packages/advene/</a>
<p>
Default views in the package allow us to browse its content.
<p>
<h3><a name="Transcription_view"></a>3.4. Transcription view</h3>

<p>
This view shows all the annotations of a same type as a single text. The main utilty of this view is to show a set of annotations corresponding to a dialog in order to find and localize an annotation in the text.
<p>
There are two manners to acces to this view : by right-clicking on an annotation in a tree-view and choosing <em>Transcription</em>, or through the <em>view</em> menu of the main frame.
<p>
<a name="TALESSyntax"></a>
<h2><a name="TALES_syntax"></a>4. TALES syntax</h2>

<p>
The TALES syntax (<em>TAL Expression Syntax</em>) is used in several components of advene :
<UL >
<li> in the web server (address building)
<li> in dynamic views (definition of the conditions and parameters of the actions)
<li> in static views (patterns of replacement)
<li> in simple queries (definition of the conditions)
</UL>
<p>
It's important to understand this syntax and the Advene model, to better exploit the possibilities offered by Advene.
<p>
<h3><a name="The_Advene_model"></a>4.1. The Advene model</h3>

<p>
FIXME Hierarchy (package, schemes, annotationTypes, relationTypes, annotations, relations, views, resources)
<p>
This hierarchy can be considered as a file system in which there are elements. A TALES expression will then be a path in this file system.
<p>
A particularity of Advene is that some elements can be reached by several paths. An annotation will be in the <tt>package/annotations</tt> "directory" and in the <tt>package/annotationTypes/simple_text/annotations</tt> "directory" too.
<p>
<h3><a name="TALES_use_in_the_web_server"></a>4.2. TALES use in the web server</h3>

<p>
The integrated web server directly interprets TALES expressions. It's so possible to browse the data structure and it's content.
The start point of TALES expressions is the URL 
<a href="http://localhost:1234/packages/advene/">http://localhost:1234/packages/advene/</a>
<p>
The following will be interpreted as a TALES expression.
<p>
So,
<p>
<a href="http://localhost:1234/packages/advene/annotationTypes/simple_text/annotations/a4">http://localhost:1234/packages/advene/annotationTypes/simple_text/annotations/a4</a>
<p>
will return the annotation with the <tt>a4</tt> identifier contained in the set of annotations with the <tt>simple_text</tt> type. 
<p>
<h3><a name="TALES_use_in_the_static_views"></a>4.3. TALES use in the static views</h3>

<p>
The static views (UTBV) allow to specify a render mode for each element of the model. They consist of models of documents (<em>templates</em>) using TAL syntax. TAL is using TALES to specify which content must be inserted into the specified location.
<p>
Base elements of the TALES expressions are :
<p>
<UL >
<li> <tt>here</tt> : current element
<li> <tt>request</tt> : parameters passed to the view (through the web interface, in an expression like <a href="http://localhost:1234/packages/advene?foo=1&amp;bar=toto&lt;/tt&gt">http://localhost:1234/packages/advene?foo=1&amp;bar=toto&lt;/tt&gt</a>;
<li> <tt>options</tt> : a set of optionnal elements :
<UL >
<li> <tt>options/package_url</tt> : current package URL
<li> <tt>options/snapshot</tt> : access to the saved snapshots
<li> <tt>options/config</tt> : configuration options
</UL>
</UL>
<p>
<a name="STBVRootElements"></a>
<h3><a name="TALES_use_in_the_dynamic_views"></a>4.4. TALES use in the dynamic views</h3>

<p>
Similar elements are available in the dynamic views, in order to specify at the same time the conditions having to be filled and the parameters of the actions to be carried out.  On the other hand, more "basic" elements are accessible, of which some are only defined on particular events:
<p>
<UL >
<li> <tt>package</tt> : current package
<li> <tt>annotation</tt> : the annotation which started the event
<li> <tt>relation</tt> : the relation which started the event
<li> <tt>activeAnnotations</tt> : the list of the actives annotations
<li> <tt>player</tt> : the video player
<li> <tt>event</tt> : the name of the event
</UL>
<p>
<a name="QueryRootElements"></a>
<h3><a name="TALES_use_in_the_queries"></a>4.5. TALES use in the queries</h3>

<p>
Queries also use a TALES syntax, making it possible to specify
<OL >
<li> the set of elements on which a filter will be applied
<li> conditions of taking into account of an element
<li> the return value
</OL>
<p>
For the last two parameters, an additional basic element is defined.  It has as for name <tt>element</tt> and takes the value of the tested element. Let us recall that the basic element <em>here</em> corresponds then to the value of the element to which the query is applied.
<p>
Thus, to obtain the annotations of same type preceding the annotation to which the query is applied, and to return their identifiers, we use the following syntax:
<p>
<UL >
<li> Starting set: <tt>here/type/annotations</tt>
<li> Condition:  <tt>element</tt> <em>is before (Allen)</em> <tt>here</tt>
<li> Return value: <tt>element/id</tt>
</UL>
<p>
and we apply the query to the desired annotation through a TALES expression :
<p>
<tt>package/annotations/last/query/annotations_before</tt>
<p>
<a name="Resources"></a>
<h3><a name="Access_to_package_specific_resources"></a>4.6. Access to package-specific resources</h3>

<p>
By using the new <tt>.azp</tt> package format (just save an .xml package with the .azp extension), you can add resources (any kind of file) to the package itself. It is commonly used for stylesheets used by the package's static views.
<p>
You can browse and edit (add, delete) resources through the tree view, which will display a new <tt>Resources</tt> item.
You can access the resources with TALES expressions such as
<p>
<tt>package/resources/style.css</tt>
<p>
If you want to use the resource, you can choose to either embed its content in the view, or reference it:
<p>
<pre>
&lt;!-- Embedding the resources content --&gt;
&lt;html&gt;...&lt;style type="text/css" tal:content="package/resources/style.css/content/data"&gt;&lt;/style&gt;...
</pre>
<p>
<pre>
&lt;!-- Referencing the resource --&gt;
&lt;html&gt;...&lt;link tal:attributes="href package/resources/style.css/absolute_url" type="text/css" rel="stylesheet" /&gt;
</pre>
<p>
<h2><a name="Dynamic_views"></a>5. Dynamic views</h2>

<p>
<h3><a name="Definition"></a>5.1. Definition</h3>

<p>
A dynamic view is a set of rules, which will be applied playing a video.  Playing the video, with the structure of annotation, allows to generate a certain number of events (<tt>AnnotationBegin</tt>, <tt>AnnotationEnd</tt>, <tt>PlayerPause</tt>, etc).  A rule will specify
<p>
<OL >
<li> the event which can start it
<li> a set of conditions to check
<li> a set of actions to be carried out
</OL>
<p>
The syntax of the conditions uses the <a href="#TALESSyntax">[TALES syntax]</a>, enriched by a certain number of <a href="#STBVRootElements">[root elements]</a> specific to the context (the starting annotation, the event itself, etc).
<p>
The most current use is to filter the event <tt>AnnotationBegin</tt> on a particular type of annotation, which gives following syntax:
<p>
<tt>annotation/type</tt> <em>is equal to</em> <tt>packages/annotationTypes/foobar</tt>
<p>
<a name="DefaultSTBV"></a>
<h3><a name="Automatic_launching"></a>5.2. Automatic launching</h3>

<p>
It is possible to specify a default dynamic view, which will be activated when loading the package.  For that, it is necessary to edit the package itself (via a right-click at the root of the tree view) and to indicate in the field <em>Default dynamic view</em> the identifier of the dynamic view.
<p>
To carry out particular actions (showing a message, starting the video player, etc), we need to specify in the dynamic view a rule reacting to the event <em>Activation of the view</em>.
<p>
<h2><a name="Static_views"></a>6. Static views</h2>

<p>
<a name="DefaultUTBV"></a>
<h3><a name="Default_static_view"></a>6.1. Default static view</h3>

<p>
It is possible to specify a default static view, which will be loaded when clicking on the button <em>Web Browser</em> in the toolbar.  For that, it is necessary to edit the package itself (via the tree view) and to indicate in the field <em>Default static view</em> the identifier of the view.
<p>
<h2><a name="Schema_definition"></a>7. Schema definition</h2>

<p>
<h3><a name="New_schema_creation"></a>7.1. New schema creation</h3>

<p>
The creation of a new schema is carried out starting from the arborescent view. We need to right-click on the collection and to select <em>Create a new schema</em>, then to provide requested informations. It is also possible to use the "V" icon in the main window toolbar.
<p>
<h3><a name="Adding_an_annotation_type_to_a_schema"></a>7.2. Adding an annotation type to a schema</h3>

<p>
The creation of a new type of annotation is carried out starting from the arborescent view. We need to right-click on the schema in which we wish to create the new type and to select <em>Create a new type of annotation</em>, then to provide requested informations.
<p>
<h3><a name="Adding_a_relation_type_to_a_schema"></a>7.3. Adding a relation type to a schema</h3>

<p>
The creation of a new type of relation is carried out starting from the arborescent view. We need to right-click on the schema in which we wish to create the new type and to select <em>Create a new type of relation</em>, then to provide requested informations.
<p>
<h2><a name="Package_elements_edition"></a>8. Package elements edition</h2>

<p>
The edition of the elements of the package is possible from the various views. We initially advise to use the arborescent view in order to perceive the structure of informations.
<p>
<h3><a name="Shared_attributes"></a>8.1. Shared attributes</h3>

<p>
Each element in the model has the following attributes :
<p>
<UL >
<li> <tt>URI</tt>: element URI (i.e. package URI + element identifier)
<li> <tt>id</tt>: element identifier (not for the package)
<li> <tt>Title</tt>: element title (which will be shown in the different view instead of the id)
<li> <tt>Author</tt>: element creator
<li> <tt>Date</tt>: creation date of the element
<li> <tt>Description</tt>: a short description of the element
</UL>
<p>
Attributes <tt>URI</tt> and <tt>id</tt> aren't modifiable (they're so shown in bold). 
<p>
<h3><a name="Package_specific_attributes"></a>8.2. Package specific attributes</h3>

<p>
The packages have two additional attributes, <em><a href="#DefaultSTBV">[Default dynamic view]</a></em> and <em><a href="#DefaultUTBV">[Default static view]</a></em>, which make it possible to specify default views to be activated during the loading of the package or activation of the Web Browser.
<p>
<h3><a name="Annotation_types"></a>8.3. Annotation types</h3>

<p>
Types of annotations allow to specify the MIME type of the contents of their annotations (field <em>MIME type</em>), as well as an expression of generation of the representation of the annotations (field <em>Representation</em>).
For the first field, values typicaly are 
<p>
<UL >
<li> <tt>text/plain</tt>: simple text
<li> <tt>application/x-advene-structured</tt>: a <a href="#AdveneStructured">[Simplistic structured form]</a>
<li> <tt>text/xml</tt>: XML
</UL>
<p>
The second field (<em>Representation</em>) allows to indicate an expression to be applied to the annotation of the edited type.  Its typical use is in the case of a structured type of annotation (in the Simplistic structured form, or in XML, etc), where we do not want to represent the corresponding annotations by their entire contents. We can so specify the field to be used to build the representation, via a TALES expression.
<p>
Thus, a structured annotation whith the fields <tt>title</tt>, <tt>content</tt> and <tt>number</tt> will be able to use as a representation
<p>
<tt>here/content/parsed/title</tt>
<p>
or
<p>
<tt>string:${here/content/parsed/number}: ${here/content/parsed/title}</tt>
<p>
<p>
<a name="AdveneStructured"></a>
<h4><a name="Simplistic_structured_form"></a>8.3.1. Simplistic structured form</h4>

<p>
The simplistic structured form allows to create annotations easily containing various fields.  For that, we create as many lines as of fields, where each line looks like <pre>name=value</pre>
Thus, a structured annotation whith the fields <tt>title</tt>, <tt>content</tt> and <tt>number</tt> could contain
<p>
<pre>
number=42
title=Surprise !
content=The hero is entering a room, finding all his friends.
</pre>
<p>
The exploitation of this type of content is carried out in the TALES expressions using the method <tt>parsed</tt> applied to the content. Thus, to reach the number of the plan, we use the syntax <tt>here/content/parsed/number</tt>
<p>
<h3><a name="Relation_types"></a>8.4. Relation types</h3>

<p>
The types of relations allows to enforce the type of the annotations in relation. That is carried out in the edition window via the field <em>Members</em> where it is possible to insert, remove and reorder the types of annotations.
<p>
<h3><a name="Views"></a>8.5. Views</h3>

<p>
The views are applicable on any element of the model.  It is possible to force their use to certain types of elements by specifying the fields <em>Class</em> and <em>Type</em>. The field <em>Class</em> is by default fixed at <tt>'''</tt>, indicating the generic character of the view. If we wish to restrict his application to a package, <tt>package</tt> should be indicated. The various possible values are:
<p>
<UL >
<li> <tt>package</tt>
<li> <tt>schema</tt>
<li> <tt>annotation-type</tt>
<li> <tt>relation-type</tt>
<li> <tt>view</tt>
<li> <tt>annotation</tt>
<li> <tt>relation</tt>
<li> <tt>list</tt> : In this case, we can indicate the type of the elements in the list, in the field <em>Type</em>
</UL>
<p>
Each view has a MIME type, defining its contents.  This field generally contains the values <tt>text/html</tt> (HTML), <tt>image/svg+xml</tt> (SVG) or <tt>text/plain</tt> (simple text).
<p>
The dynamic views are a particular case, using an internal type: <tt>application/x-advene-ruleset</tt>, and applying to a package.
<p>
You can read some [<a href="http://zopewiki.org/PageTemplateStyleGuide">[1]</a>[advice about the writing of Zope Page Templates]].
<p>
There is no Advene-specific template user guide yet. The best way to define new templates is to have a look at existing documents.
<p>
<h1>To do</h1>

<p>
<UL >
<li> reaction time value
<li> advene model
</UL>
<p>
</div><hr class=wikilinefooter>


Last edited March 6, 2006 4:28 pm by pepper.info.enstb.org  (diff)
</form></div></body></html>