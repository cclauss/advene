
<package xmlns='http://experience.univ-lyon1.fr/advene/ns' xmlns:dc='http://purl.org/dc/elements/1.1/' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:tst='http://experience.univ-lyon1.fr/advene/ns/test' id='test' dc:creator='oaubert' dc:date='2004-01-20'>
  <meta>
    <title xmlns='http://purl.org/dc/elements/1.1/'>Template package</title>
  </meta>
  <imports>
  </imports>
  <annotations>
  </annotations>
  <queries>
  </queries>
  <schemas>
    <schema id='simple-text'>
      <meta>
        <dc:title>Simple text</dc:title>
        <dc:subject>Basic schema for annotating with free text</dc:subject>
      </meta>
      <annotation-types>
        <annotation-type dc:creator='Advene team' id='annotation'>
          <meta>
            <representation xmlns='http://experience.univ-lyon1.fr/advene/ns/advenetool'></representation>
            <description xmlns='http://purl.org/dc/elements/1.1/'>Simple text annotation</description>
            <dc:title>Text annotation</dc:title>
            <dc:subject>A simple text annotation</dc:subject>
          </meta>
          <content-type mime-type='text/plain'/>
        </annotation-type>
      </annotation-types>
      <relation-types>
        <relation-type dc:creator='Advene team' id='basic-relation'>
          <meta>
            <dc:title>Basic relation</dc:title>
            <dc:description>Simple relation between two annotations.</dc:description>
          </meta>
          <member-type xlink:href='#annotation'/>
          <member-type xlink:href='#annotation'/>
          <content-type mime-type='text/plain'/>
          <!-- TODO eventually, this would be an ad-hoc xml schema
          <content-type mime-type="text/xml">
            <schema>...</schema>
          </content-type>
          -->
          <member-types>
            <member-type xlink:href='#annotation'/>
            <member-type xlink:href='#annotation'/>
          </member-types>
        </relation-type>
      </relation-types>
    </schema>
  </schemas>
  <views>
    <view viewable-class='annotation' dc:creator='' id='annotation-view'>
      <content mime-type='text/html'>&lt;a tal:attributes="href here/absolute_url">annotation &lt;em tal:content="here/id">Id&lt;/em>&lt;/a> (&lt;a tal:attributes="href here/player_url">Play fragment&lt;/a> | &lt;a href="/media/pause">Pause&lt;/a> | &lt;a href="/media/stop">Stop&lt;/a> )
</content>
    </view>
    <view viewable-class='package' dc:creator='oaubert' id='package-view'>
      <meta>
        <title xmlns='http://purl.org/dc/elements/1.1/'>Default package view</title>
      </meta>
      <content mime-type='text/html'>&lt;h1>Contents of package &lt;em tal:content="here/title">Title&lt;/em> created by &lt;address tal:content="here/author">author&lt;/address>&lt;/h1>

&lt;h2>&lt;a tal:attributes="href here/annotations/absolute_url">Annotations (&lt;em tal:content="python:len(here.annotations)">Number&lt;/em>)&lt;/a>&lt;/h2>

&lt;table border="1">
&lt;tr>
&lt;th>Annotation type&lt;/th>
&lt;th>MIME Type&lt;/th>
&lt;th>Annotations count&lt;/th>
&lt;/tr>

&lt;tr tal:repeat="at here/annotationTypes">
   &lt;td>&lt;a tal:attributes="href at/absolute_url"
                 tal:content="at/title | at/id">Annotation Type&lt;/a>&lt;/td>
   &lt;td tal:content="at/mimetype">Mime-Type&lt;/td>
   &lt;td>&lt;span tal:replace="python:len(at.annotations)">Number&lt;/span>
           (&lt;a tal:attributes="href string:${at/absolute_url}/view/annotation_list_view">view&lt;/a>)&lt;/td>
&lt;/tr>
&lt;/table>

&lt;h2>&lt;a tal:attributes="href here/relations/absolute_url">Relations (&lt;em tal:content="python:len(here.relations)">Number&lt;/em>)&lt;/a>&lt;/h2>

&lt;table border="1">
&lt;tr>
&lt;th>Relation type&lt;/th>
&lt;th>MIME Type&lt;/th>
&lt;th>Relations count&lt;/th>
&lt;/tr>

&lt;tr tal:repeat="rt here/relationTypes">
   &lt;td>&lt;a tal:attributes="href rt/absolute_url"
                 tal:content="rt/title | rt/id">Relation Type&lt;/a>&lt;/td>
   &lt;td tal:content="rt/mimetype">Mime-Type&lt;/td>
   &lt;td>&lt;span tal:replace="python:len(rt.relations)">Number&lt;/span>
           (&lt;a tal:attributes="href string:${rt/absolute_url}/view/relation_list_view">view&lt;/a>)&lt;/td>
&lt;/tr>
&lt;/table>

&lt;h2>&lt;a tal:attributes="href string:${here/absolute_url}/views/view/views-view">Vues&lt;/a>&lt;/h2>

&lt;span tal:replace="structure here/views/view/views-view">Views&lt;/span>

&lt;h2>&lt;a tal:attributes="href string:${here/absolute_url}/schemas">Schemas&lt;/a>&lt;/h2>
&lt;ul>
  &lt;li tal:repeat="s here/schemas">
   &lt;a tal:attributes="href s/absolute_url" tal:content="structure s/view/item-view">Schema&lt;/a>
  &lt;/li>
&lt;/ul>
</content>
    </view>
    <view viewable-class='list' id='bundle-view'>
      <content mime-type='text/html'>&lt;ul>
&lt;li tal:repeat="item here">
   &lt;a tal:attributes="href item/absolute_url" tal:content="structure item/view/item-view">Item&lt;/a>
&lt;/li>
&lt;/ul></content>
    </view>
    <view viewable-class='list' id='schema-bundle-view'>
      <content mime-type='text/html'>&lt;h1>Schemas list&lt;/h1>

&lt;ul tal:repeat="item here/ids">
   &lt;a tal:attributes="href item/absolute_url" tal:content="structure item/view/item-view">Item&lt;/a>
&lt;/ul></content>
    </view>
    <view viewable-class='view' id='view-view'>
      <content mime-type='text/html'>&lt;p>View &lt;strong tal:content="here/id">Id&lt;/strong> valid for &lt;em tal:content="here/matchFilter">class&lt;/em>&lt;/p>
&lt;pre tal:content="here/content/data">
Contenu
&lt;/pre></content>
    </view>
    <view viewable-class='annotation-type' id='annotation-type-view'>
      <content mime-type='text/html'>&lt;p>Type &lt;a tal:attributes="href here/absolute_url">&lt;em tal:content="here/id">id&lt;/em> : &lt;span tal:replace="here/title">Titre&lt;/span>&lt;/a>&lt;br />
&lt;span tal:condition="here/meta/dc/description">
Description : &lt;em tal:content="here/meta/dc/description">description&lt;/em>&lt;br />
&lt;/span>
&lt;a tal:attributes="href here/annotations/absolute_url" tal:content="python: '%d annotation(s)' % len(here.annotations)">Annotations count&lt;/a>&lt;/p></content>
    </view>
    <view viewable-class='*' id='edit-content'>
      <content mime-type='text/html'>&lt;span tal:condition="python: hasattr(here, 'content')">
&lt;form method="POST" tal:attributes="action here/absolute_url">
&lt;textarea tal:attributes="cols options/config/edit-width | 60; rows options/config/edit-height | 20" tal:content="here/content/data" rows="20" cols="60" name="data">
Contenu
&lt;/textarea>&lt;br />
&lt;input type="hidden" name="key" value="contentData">
&lt;input type="hidden" name="action" value="update">
&lt;input type="submit" value="Valider" />
&lt;/form>
&lt;/span>

&lt;span tal:condition="python: not hasattr(here, 'content')">
&lt;p>This view only applies on elements possessing a content.&lt;/p>
&lt;/span>
</content>
    </view>
    <view viewable-class='*' id='generic'>
      <content mime-type='text/html'>&lt;p>Generic view of &lt;span tal:replace="here/uri">URI&lt;/span>&lt;/p>
</content>
    </view>
    <view viewable-class='*' id='item-view'>
      <content mime-type='text/html'>&lt;span tal:replace="here/viewableClass">Classe&lt;/span>
&lt;strong tal:content="here/id">Id&lt;/strong>
&lt;span tal:condition="exist: here/matchFilter" comment="is_a_view">
 valid for &lt;em tal:content="here/matchFilter">filtre&lt;/em>
&lt;/span>
</content>
    </view>
    <view viewable-class='schema' id='schema-view'>
      <content mime-type='text/html'>&lt;h2>Schema &lt;strong tal:content="here/title | here/id">Title&lt;/strong> (&lt;em tal:content="here/id">Id&lt;/em>)&lt;/h2>

&lt;p>Description : &lt;em tal:content="here/meta/dc/description | string:Unknown.">Description&lt;/em>&lt;/p>

&lt;p>Defined annotation types :&lt;/p>

&lt;ul>
  &lt;li tal:repeat="t here/annotationTypes">
   &lt;span tal:replace="structure t/view/annotation-type-view">Type&lt;/span>
&lt;/li>
&lt;/ul>

&lt;p>Defined relation types :&lt;/p>

&lt;ul>
  &lt;li tal:repeat="t here/relationTypes">
   &lt;span tal:replace="structure t/view/relation-type-view">Type&lt;/span>
&lt;/li>
&lt;/ul>
</content>
    </view>
    <view viewable-class='schema' id='add-view'>
      <content mime-type='text/html'>&lt;h1>Create a new view in the package &lt;em tal:content="here/ownerPackage/uri">Nom&lt;/em>&lt;/h1>
&lt;form method="POST" tal:attributes="action here/ownerPackage/absolute_url">

&lt;input type="hidden" name="type" value="view">
&lt;input type="hidden" name="action" value="create">

Identifier : &lt;input type="text" name="id">&lt;br />
Valid for : &lt;select name="class">
&lt;option>*&lt;/option>
&lt;option>annotation&lt;/option>
&lt;option>annotation-type&lt;/option>
&lt;option>content&lt;/option>
&lt;option>fragment&lt;/option>
&lt;option>list&lt;/option>
&lt;option>package&lt;/option>
&lt;option>query&lt;/option>
&lt;option>relation&lt;/option>
&lt;option>relation-type&lt;/option>
&lt;option>schema&lt;/option>
&lt;option>view&lt;/option>
&lt;/select>&lt;br />
Content :&lt;br />
&lt;textarea name="data" rows="20" cols="80">
&lt;/textarea>&lt;br />
&lt;input type="submit" value="Create">
&lt;/form>
</content>
    </view>
    <view viewable-class='annotation' id='full-view'>
      <content mime-type='text/html'>&lt;h1>Annotation &lt;em tal:content="here/id">Id&lt;/em>&lt;/h1>

&lt;p>Begin: &lt;span tal:replace="here/fragment/begin">Begin&lt;/span>&lt;/p>

&lt;p>End: &lt;span tal:replace="here/fragment/end">End&lt;/span>&lt;/p>
&lt;p>Type: &lt;span tal:replace="here/type">Type&lt;/span>&lt;/p>
&lt;p>Content-Type: &lt;span tal:replace="here/content/mimetype">Content-type&lt;/span>&lt;/p>
&lt;p>&lt;a tal:attributes="href string:${here/content/absolute_url}/data">Content&lt;/a>&lt;/p>
</content>
    </view>
    <view viewable-class='view' id='epoz'>
      <content mime-type='text/html'>    &lt;div class="epoz-fulleditor" metal:use-macro="epozmacros/macros/epoz_fulleditor">
      &lt;iframe metal:fill-slot="epoz_editorframe"
              id="epoz-editor"
              class="epoz-editorframe" 
              usecss="1"
              tal:attributes="src string:${here/content/data/absolute_url}?mode=raw;
                              dst here/content/absolute_url"
       onload="startEpoz()">              
&lt;/iframe>
    &lt;/div>
</content>
    </view>
    <view viewable-class='list' id='views-view'>
      <content mime-type='text/html'>&lt;table border="1">
  &lt;tr>
  &lt;th>Identifier&lt;/th>
  &lt;th colspan="2">Filtre&lt;/th>
  &lt;th>Actions&lt;/th>
  &lt;/tr>

 &lt;tr tal:repeat="v here">
    &lt;td>
     &lt;a tal:attributes="href v/absolute_url" tal:content="structure v/id">View Id&lt;/a>
    &lt;/td>
    &lt;td tal:content="v/matchFilter/class">Class&lt;/td>
    &lt;td tal:content='structure v/matchFilter/type | string::'>Type&lt;/td>
    &lt;td>
&lt;a title="Edit the view" tal:attributes="href string:${v/absolute_url}/view/edit-content">Edit&lt;/a>
&lt;span tal:condition='python: v.match(v.rootPackage)'>
&lt;span  tal:condition='python:not "ruleset" in v.content.mimetype'>
| &lt;a title="WYSIWYG edit of the view" tal:attributes="href string:${v/absolute_url}/view/epoz">Epoz&lt;/a>
| &lt;a title="Apply the view on the package" tal:attributes="href string:${v/rootPackage/absolute_url}/view/${v/id}">Apply&lt;/a> &lt;/span>
&lt;/span>
&lt;span  tal:condition='python:"ruleset" in v.content.mimetype'>
| &lt;a title="Activate the dynamic view" tal:attributes="href string:/media/stbv?id=${v/id}">Activate&lt;/a> 
&lt;/span>
  &lt;/td>
  &lt;/tr>
 
&lt;/table>
</content>
    </view>
    <view viewable-class='relation' id='relation-view'>
      <content mime-type='text/html'>Relation &lt;em tal:content="here/id">Id&lt;/em> entre &lt;a href="annotation1" tal:attributes="href here/members/first/absolute_url" tal:content="here/members/first/content/data">Annotation 1&lt;/a> et &lt;a href="annotation2" tal:attributes="href here/members/last/absolute_url" tal:content="here/members/last/content/data">Annotation 2&lt;/a></content>
    </view>
    <view viewable-class='annotation-type' id='type-view'>
      <content mime-type='text/html'>&lt;p>Type &lt;em tal:content="here/id">id&lt;/em> : &lt;span tal:replace="here/title">Title&lt;/span>&lt;/p>
&lt;p>&lt;a here="annotations" tal:attributes="href here/annotations" tal:content="python: '%d annotations' % len(here.annotations)">Annotations count&lt;/a> definies.&lt;/p>
</content>
    </view>
    <view viewable-class='relation-type' id='relation-type-view'>
      <content mime-type='text/html'>&lt;p>Type &lt;a tal:attributes="href here/absolute_url">&lt;em tal:content="here/id">id&lt;/em> : &lt;span tal:replace="here/title">Titre&lt;/span>&lt;/a>&lt;br />
&lt;span tal:condition="here/meta/dc/description">
Description : &lt;em tal:content="here/meta/dc/description">description&lt;/em>&lt;br />
&lt;/span>
&lt;a tal:attributes="href here/relations/absolute_url" tal:content="python: '%d relation(s)' % len(here.relations)">Relations count&lt;/a>&lt;/p></content>
    </view>
    <view viewable-class='package' dc:date='2004-06-08' dc:creator='oaubert' id='text-caption'>
      <meta>
        <title xmlns='http://purl.org/dc/elements/1.1/'>Display annotations on the video</title>
      </meta>
      <content mime-type='application/x-advene-ruleset'>&lt;?xml version='1.0' encoding='UTF-8'?>
&lt;ruleset xmlns='http://experience.univ-lyon1.fr/advene/ns/advenetool'>
  &lt;rule name='Caption annotations'>
    &lt;event name='AnnotationBegin'/>
    &lt;condition operator='equals' rhs='string:text/plain' lhs='annotation/content/mimetype'/>
    &lt;action name='AnnotationCaption'>
      &lt;param name='message' value='annotation/content/data'/>
    &lt;/action>
  &lt;/rule>
&lt;/ruleset>
</content>
    </view>
    <view viewable-class='*' dc:date='2004-06-30' dc:creator='oaubert' id='annotation_list_view'>
      <meta>
        <title xmlns='http://purl.org/dc/elements/1.1/'>annotation_list_view</title>
      </meta>
      <content mime-type='text/html'>&lt;h2>&lt;a tal:attributes="href here/annotations/absolute_url">Annotations of &lt;span tal:replace="here/title | here/id">element&lt;/span> (&lt;em tal:content="python:len(here.annotations)">Number&lt;/em>)&lt;/a>&lt;/h2>

&lt;table width="100%" border="1">

&lt;tr>
&lt;th>Id&lt;/th>
&lt;th>Begin&lt;/th>
&lt;th>End&lt;/th>
&lt;th>Content&lt;/th>
&lt;/tr>

&lt;tr tal:repeat="a here/annotations">

&lt;td>
&lt;a tal:attributes="href a/absolute_url; title a/type/title | a/type/id" tal:content="a/id">Id&lt;/a>
&lt;/td>

&lt;td>
&lt;a tal:attributes="href a/player_url; title string:Play the fragment" tal:content="a/fragment/formatted/begin">Begin&lt;/a>
&lt;/td>

&lt;td>
&lt;a tal:attributes="href string:/media/play/${a/fragment/end}; title string:Play the movie" tal:content="a/fragment/formatted/end">End&lt;/a>
&lt;/td>

&lt;td tal:content="a/content/data">Content&lt;/td>

&lt;/tr>

&lt;/table>
</content>
    </view>
  </views>
</package>
